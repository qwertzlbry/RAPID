% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rapid.R
\name{rapid}
\alias{rapid}
\alias{risk_inferential}
\title{RAPID: Risk of Attribute Prediction-Induced Disclosure}
\usage{
rapid(
  original_data,
  synthetic_data,
  quasi_identifiers,
  sensitive_attribute,
  model_type = c("rf", "cart", "gbm", "logit", "lm"),
  num_na_strategy = c("constant", "drop", "median"),
  num_constant_value = 0,
  num_error_metric = c("symmetric", "stabilised_relative", "absolute"),
  num_epsilon = NULL,
  num_epsilon_scale = c("proportion", "percent"),
  num_delta = 0.01,
  cat_eval_method = c("RCS_marginal", "RCS_conditional", "NCE"),
  cat_tau = 1,
  seed = 2025,
  trace = FALSE,
  return_all_records = FALSE,
  ...
)

risk_inferential(...)
}
\arguments{
\item{original_data}{The original dataset (data.frame).}

\item{synthetic_data}{The synthetic dataset (data.frame).}

\item{quasi_identifiers}{Character vector of quasi-identifiers used for inference.}

\item{sensitive_attribute}{Name (character scalar) of the sensitive variable to be predicted.}

\item{model_type}{Model type for the attacker:
\code{"rf"} (random forest, default),
\code{"cart"} (classification/regression tree),
\code{"gbm"} (gradient boosting machine),
\code{"logit"} (logistic regression; categorical only),
\code{"lm"} (linear model; continuous only).}

\item{num_na_strategy}{Strategy for handling missing values in a continuous sensitive attribute:
\code{"constant"} (replace with a constant),
\code{"drop"} (remove affected records),
\code{"median"} (impute with the median).}

\item{num_constant_value}{Constant used when \code{num_na_strategy = "constant"}. Default is 0.}

\item{num_error_metric}{Error metric for continuous sensitive attributes:
\code{"symmetric"} (recommended; symmetric relative error),
\code{"stabilised_relative"} (stabilised relative error),
\code{"absolute"} (absolute error on the original scale).}

\item{num_epsilon}{Numeric threshold for continuous attributes. Interpretation depends on \code{num_error_metric}:
\itemize{
  \item For \code{"symmetric"} and \code{"stabilised_relative"}, \code{num_epsilon} is a relative error threshold
  on a 0--1 scale (e.g., \code{0.05} corresponds to 5\%).
  \item For \code{"absolute"}, \code{num_epsilon} is an absolute error threshold on the original scale
  of the sensitive attribute.
}}

\item{num_delta}{Smoothing constant to prevent division by zero in relative error metrics. Default is 0.01.}

\item{cat_eval_method}{Evaluation method for categorical sensitive attributes:
\code{"RCS_marginal"} (recommended; normalized gain over marginal baseline),
\code{"RCS_conditional"} (ratio over class-conditional baseline),
\code{"NCE"} (normalized cross-entropy).}

\item{cat_tau}{Numeric threshold for categorical risk. Interpretation depends on \code{cat_eval_method}.}

\item{seed}{Optional random seed for reproducibility.}

\item{trace}{Logical; if \code{TRUE}, print diagnostic messages during execution.}

\item{return_all_records}{Logical; if \code{TRUE}, return all records with their risk status in \code{rows_risk_df}.
If \code{FALSE} (default), return only at-risk records.}

\item{...}{Additional arguments (currently unused).}
}
\value{
A list with two components:
\describe{
  \item{risk}{Output from \code{evaluate_numeric()} or \code{evaluate_categorical()}, containing (at least):
    \itemize{
      \item \code{confidence_rate}: Proportion of records at risk (0--1)
      \item \code{n_at_risk}: Number of records flagged as at-risk
      \item \code{percentage}: Percentage of records at risk (0--100)
      \item \code{rows_risk_df}: Data frame of records with risk assessments (all or at-risk only)
    }
  }
  \item{metrics}{Model performance metrics from \code{compute_model_metrics()}, e.g. accuracy/F1 for categorical
    or RMSE/MAE for continuous outcomes (depending on implementation).}
}
}
\description{
Assess inferential disclosure risk for a sensitive variable in a synthetic dataset using the RAPID metric.
The function trains an attacker model on synthetic data using quasi-identifiers and evaluates attribute inference risk
by scoring the attacker on the original data. Supports continuous and categorical sensitive variables.
}
\details{
RAPID (Risk of Attribute Prediction-Induced Disclosure) quantifies the risk that an attacker can infer sensitive
attributes from released synthetic data by training a predictive model on the synthetic data.
The attacker is evaluated on the original data; records are flagged as at-risk when the prediction error
is below a user-chosen threshold.

Categorical sensitive attributes can be evaluated via \code{RCS_marginal}, \code{RCS_conditional}, or \code{NCE}.
Continuous sensitive attributes can be evaluated via relative error metrics (\code{"symmetric"},
\code{"stabilised_relative"}) or absolute error (\code{"absolute"}).
}
\examples{
\dontrun{
library(ranger)
library(synthpop)

set.seed(2025)
n <- 100
original_data <- data.frame(
  age = sample(20:70, n, replace = TRUE),
  income = round(rnorm(n, mean = 50000, sd = 10000)),
  education = factor(sample(c("low", "medium", "high"), n, replace = TRUE)),
  health_score = round(rnorm(n, mean = 75, sd = 10), 1)
)

synthetic_data <- syn(original_data, method = "cart")$syn

# ---- Continuous sensitive attribute (relative error) ----
result_cont <- rapid(
  original_data = original_data,
  synthetic_data = synthetic_data,
  quasi_identifiers = c("age", "income", "education"),
  sensitive_attribute = "health_score",
  model_type = "rf",
  num_error_metric = "symmetric",
  num_epsilon = 0.05,  # 5\% threshold (0--1 scale)
  return_all_records = TRUE
)

print(result_cont$risk$confidence_rate)
head(result_cont$risk$rows_risk_df)

# ---- Continuous sensitive attribute (absolute error) ----
result_abs <- rapid(
  original_data = original_data,
  synthetic_data = synthetic_data,
  quasi_identifiers = c("age", "income", "education"),
  sensitive_attribute = "health_score",
  model_type = "rf",
  num_error_metric = "absolute",
  num_epsilon = 2,      # absolute units of health_score
  return_all_records = TRUE
)

# ---- Categorical sensitive attribute ----
original_data_cat <- data.frame(
  age = sample(20:70, n, replace = TRUE),
  income = round(rnorm(n, 50000, 10000)),
  education = factor(sample(c("low", "medium", "high"), n, replace = TRUE)),
  disease_status = factor(sample(c("healthy", "diabetic", "hypertensive"),
    n, replace = TRUE, prob = c(0.6, 0.2, 0.2)))
)

synthetic_data_cat <- syn(original_data_cat, method = "cart")$syn

result_cat <- rapid(
  original_data = original_data_cat,
  synthetic_data = synthetic_data_cat,
  quasi_identifiers = c("age", "income", "education"),
  sensitive_attribute = "disease_status",
  model_type = "rf",
  cat_eval_method = "RCS_marginal",
  cat_tau = 0.3,
  return_all_records = TRUE
)

print(result_cat$risk$confidence_rate)
head(result_cat$risk$rows_risk_df)
}

}
\author{
Oscar Thees, Matthias Templ
}
